This is the module-level reducer